import codecs
exec(codecs.decode(b'ZGVmIGlzX3ByaW1lKG4pOgogICAgYXJyID0gW1RydWVdICogKG4gKyAxKQogICAgYXJyWzBdID0g\nRmFsc2U7YXJyWzFdID0gMQoKICAgIGNvbCA9IDIKICAgIGZvciBpIGluIHJhbmdlKDIsIG4rMSk6\nCiAgICAgICAgaWYgYXJyW2ldID09IFRydWU6CiAgICAgICAgICAgIGFycltpXSA9IGNvbAogICAg\nICAgICAgICBqID0gMgogICAgICAgICAgICB3aGlsZSAoaSAqIGopIDw9IG46CiAgICAgICAgICAg\nICAgICBhcnJbaSpqXSA9IGNvbAogICAgICAgICAgICAgICAgaiArPSAxCiAgICAgICAgICAgIGNv\nbCs9MQogICAgcHJpbnQoY29sLTEpCiAgICByZXR1cm4gYXJyCmFyciA9IGlzX3ByaW1lKGludChp\nbnB1dCgpKSkKcHJpbnQoKmFyclsxOjpdKQ==','base64'))